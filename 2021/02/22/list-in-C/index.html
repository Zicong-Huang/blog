<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zicong-huang.github.io","root":"/blog/","scheme":"Muse","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>

  <meta name="description" content="顺序线性表的抽象数据模型ADT &amp;#123;     数据对象：ElemType型数据集合，此处假设为int     数据关系：每个元素有一个前驱和一个后驱，第一个元素只有后驱，最后一个元素只有前驱     基本操作：         - 初始 init_sqlist：  构造一个空的线性表         - 销毁 destroy_sqlist： 释放动态分布给线性表的内存         -">
<meta property="og:type" content="article">
<meta property="og:title" content="顺序线性表 —— C语言实现">
<meta property="og:url" content="https://zicong-huang.github.io/me.github.io/2021/02/22/list-in-C/index.html">
<meta property="og:site_name" content="ZICONG">
<meta property="og:description" content="顺序线性表的抽象数据模型ADT &amp;#123;     数据对象：ElemType型数据集合，此处假设为int     数据关系：每个元素有一个前驱和一个后驱，第一个元素只有后驱，最后一个元素只有前驱     基本操作：         - 初始 init_sqlist：  构造一个空的线性表         - 销毁 destroy_sqlist： 释放动态分布给线性表的内存         -">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-02-22T20:20:28.000Z">
<meta property="article:modified_time" content="2021-02-24T03:21:31.086Z">
<meta property="article:author" content="黄梓聪">
<meta property="article:tag" content="C语言">
<meta property="article:tag" content="数据结构">
<meta property="article:tag" content="CS">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://zicong-huang.github.io/me.github.io/2021/02/22/list-in-C/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>顺序线性表 —— C语言实现 | ZICONG</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">ZICONG</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">梓聪的个人主页</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%BA%E5%BA%8F%E7%BA%BF%E6%80%A7%E8%A1%A8%E7%9A%84%E6%8A%BD%E8%B1%A1%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.</span> <span class="nav-text">顺序线性表的抽象数据模型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.</span> <span class="nav-text">定义数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%8A%BD%E8%B1%A1%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="nav-number">3.</span> <span class="nav-text">定义抽象数据操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">3.1.</span> <span class="nav-text">初始化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%80%E6%AF%81"><span class="nav-number">3.2.</span> <span class="nav-text">销毁</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%85%E7%A9%BA"><span class="nav-number">3.3.</span> <span class="nav-text">清空</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%A9%BA"><span class="nav-number">3.4.</span> <span class="nav-text">查空</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E9%95%BF"><span class="nav-number">3.5.</span> <span class="nav-text">查长</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E5%8F%96"><span class="nav-number">3.6.</span> <span class="nav-text">提取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%92%E5%85%A5"><span class="nav-number">3.7.</span> <span class="nav-text">插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4"><span class="nav-number">3.8.</span> <span class="nav-text">删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE"><span class="nav-number">3.9.</span> <span class="nav-text">查找</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E9%A9%B1"><span class="nav-number">3.10.</span> <span class="nav-text">前驱</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E9%A9%B1"><span class="nav-number">3.11.</span> <span class="nav-text">后驱</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%81%8D%E5%8E%86"><span class="nav-number">3.12.</span> <span class="nav-text">遍历</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A1%AB%E5%85%85"><span class="nav-number">3.13.</span> <span class="nav-text">填充</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="nav-number">4.</span> <span class="nav-text">测试</span></a></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">黄梓聪</p>
  <div class="site-description" itemprop="description">想法，笔记，以及实验</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives">
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">
      

      

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zicong-huang.github.io/me.github.io/2021/02/22/list-in-C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="黄梓聪">
      <meta itemprop="description" content="想法，笔记，以及实验">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZICONG">
    </span>

    
    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          顺序线性表 —— C语言实现
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-02-22 15:20:28" itemprop="dateCreated datePublished" datetime="2021-02-22T15:20:28-05:00">2021-02-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-02-23 22:21:31" itemprop="dateModified" datetime="2021-02-23T22:21:31-05:00">2021-02-23</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="顺序线性表的抽象数据模型"><a href="#顺序线性表的抽象数据模型" class="headerlink" title="顺序线性表的抽象数据模型"></a>顺序线性表的抽象数据模型</h2><pre class="line-numbers language-none"><code class="language-none">ADT &#123;
    数据对象：ElemType型数据集合，此处假设为int
    数据关系：每个元素有一个前驱和一个后驱，第一个元素只有后驱，最后一个元素只有前驱
    基本操作：
        - 初始 init_sqlist：  构造一个空的线性表
        - 销毁 destroy_sqlist： 释放动态分布给线性表的内存
        - 清空 clear_sqlist：   将线性表重置为空表
        - 查空 is_empty：       检验线性表是否为空表
        - 查长 length_sqlist：  获取线性表长度
        - 提取 get_sqlist：     提取线性表的第i个元素
        - 插入 insert_sqlist：  在线性表第i个位置插入新元素
        - 删除 delete_sqlist：  删除线性表第i个元素并返回其值
        - 查找 locate_sqlist：  获取满足一定条件的元素在线性表中的位置
        - 前驱 prior_sqlist：   获取元素在线性表中的前驱
        - 后驱 next_sqlist：    获取元素在线性表中的后驱
        - 遍历 traverse_sqlist：用某个visit函数遍历线性表
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<a id="more"></a>


<p>在具体实现中，我们将创建三个文件：</p>
<ul>
<li><code>sqlist.h</code>：头文件，宏定义，定义数据类型，声明操作函数。</li>
<li><code>sqlist.c</code>：源文件，定义操作函数。</li>
<li><code>main.c</code>：主函数，测试该数据类型的实现。</li>
</ul>
<p>在头文件中，定义如下宏：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.h"</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LIST_INIT_SIZE</span> <span class="token expression"><span class="token number">100</span>      </span><span class="token comment">// 线性表初始存储空间</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LIST_INCREMENT</span> <span class="token expression"><span class="token number">10</span>       </span><span class="token comment">// 当线性表容量不足时，增加的额外容量</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">OVERFLOW</span> <span class="token expression">false          </span><span class="token comment">// 内存溢出</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="定义数据类型"><a href="#定义数据类型" class="headerlink" title="定义数据类型"></a>定义数据类型</h2><p>数据类型在头文件中定义。首先要注意的是，写头文件时应该加上这样的语句：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.h"</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">SQLIST</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SQLIST</span></span>
<span class="token comment">/*... 主体内容 ...*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这些语句的作用是防止宏的重复定义和函数的重复声明。另外，类型定义<code>typedef</code>的重复在C中是被禁止的。</p>
<p>假定数据类型是<code>ElemType</code>，则顺序线性表可以定义为一个结构体：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.h"</span>

<span class="token keyword">typedef</span> <span class="token keyword">int</span> ElemType<span class="token punctuation">;</span>                   <span class="token comment">// 线性表元素数据类型，这里定为int</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">tagSqList</span> <span class="token punctuation">&#123;</span>
    ElemType <span class="token operator">*</span>elem<span class="token punctuation">;</span>                     <span class="token comment">// 指向存储空间基地址的指针</span>
    <span class="token keyword">int</span> length<span class="token punctuation">;</span>                         <span class="token comment">// 当前顺序表长度</span>
    <span class="token keyword">int</span> listsize<span class="token punctuation">;</span>                       <span class="token comment">// 当前分配的存储容量(元素个数)</span>
<span class="token punctuation">&#125;</span> SqList<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里值得注意的是<code>tagSqList</code>，它在声明结构体中暂时给后面的结构体一个标签，然后再在类型定义中将<code>SqList</code>定义为<code>struct tagSqList</code>这样的类型。如果没有<code>tagSqList</code>，编译器将报错。</p>
<p>声明为<code>SqList</code>类型的变量<code>L</code>将是一个结构体，包含了存储空间基地址指针、当前顺序表长度、当前分配的存储容量这三个成员。</p>
<p>对于结构体<code>L</code>，获取元素的方法是用 <code>.</code> 运算符：用<code>L.length</code>获得顺序表长度值。</p>
<p>对于指向结构体<code>L</code>的指针<code>pL</code>，获取元素的方法是用<code>-&gt;</code>运算符：用<code>L-&gt;length</code>获得顺序表长度值。</p>
<h2 id="定义抽象数据操作"><a href="#定义抽象数据操作" class="headerlink" title="定义抽象数据操作"></a>定义抽象数据操作</h2><p>下面的操作函数将在头文件<code>sqlist.h</code>中声明，在<code>sqlist.c</code>中定义。</p>
<p>下面的大多数操作都将通过指针的方式传入线性表和获得元素值。使用指针的好处是：</p>
<ul>
<li>传入：让函数可以直接在原来的线性表上进行操作，节省制作副本的空间；</li>
<li>传出：函数可以输出关于运行成功与否的信息。记住，C中的函数只能输出一个值。</li>
</ul>
<h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>初始化一个线性表为空表。传入一个已声明的线性表指针，为其数组分配空间，初始化其长度和容量。若运行成功，返回一个真值。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">init_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
    L<span class="token operator">-></span>elem <span class="token operator">=</span> <span class="token punctuation">(</span>ElemType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>LIST_INIT_SIZE <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElemType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>L<span class="token operator">-></span>elem<span class="token punctuation">)</span> <span class="token function">exit</span><span class="token punctuation">(</span>OVERFLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 存储分配失败</span>
    L<span class="token operator">-></span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                       <span class="token comment">// 空表长度为0</span>
    L<span class="token operator">-></span>listsize <span class="token operator">=</span> LIST_INIT_SIZE<span class="token punctuation">;</span>        <span class="token comment">// 初始存储容量</span>
    <span class="token keyword">return</span> true<span class="token punctuation">;</span>          
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里要特别注意<code>malloc</code>的用法。<code>malloc</code>将分配一块指定大小的连续内存空间，并返回指向其起始地址的一个通用指针<code>void *</code>。接着，<code>(ElemType *)</code>将该指针类型强制转换。最后，<code>L-&gt;elem</code>是指向存储空间基址的指针，通过赋值语句将这个指针指向所分配的空间。这片空间的大小等于表初始大小（以元素个数为单位）乘以每个元素的大小（<code>sizeof(ElemType)</code>）。</p>
<h3 id="销毁"><a href="#销毁" class="headerlink" title="销毁"></a>销毁</h3><p>销毁线性表操作的核心是释放动态分布的内存。非动态分布的内存无需考虑。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">destroy_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">free</span><span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
        L<span class="token operator">-></span>elem <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> true<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里的重点是将存储空间基址的指针设置为空指针<code>NULL</code>。“野指针”会留下很大后患。</p>
<p><code>free()</code>函数用来释放一片动态分布的存储空间，应该传入指向该存储空间的指针。</p>
<h3 id="清空"><a href="#清空" class="headerlink" title="清空"></a>清空</h3><p>清空线性表的核心是将其长度设置为0。事实上，这是足够的。超出线性表长度的（原）内容可被视为内存空间上“随机内容”，会被其它所有操作忽视。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">clear_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        L<span class="token operator">-></span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="查空"><a href="#查空" class="headerlink" title="查空"></a>查空</h3><p>若线性表为空，返回真值。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">is_empty</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> true<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="查长"><a href="#查长" class="headerlink" title="查长"></a>查长</h3><p>获取线性表的长度。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">sqlist<span class="token punctuation">.</span>c

<span class="token keyword">int</span> <span class="token function">length_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> L<span class="token operator">-></span>length<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="提取"><a href="#提取" class="headerlink" title="提取"></a>提取</h3><p>获得线性表L中第i个元素的值，并用e返回。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">get_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> ElemType <span class="token operator">*</span>e<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> i <span class="token operator">></span> L<span class="token operator">-></span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>
    <span class="token operator">*</span>e <span class="token operator">=</span> L<span class="token operator">-></span>elem<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>此处要注意的是，线性表的是从1开始数的，而数组是从0开始数的。</p>
<p>第二个需要注意的地方是，本操作需要传入一个<code>ElemType *</code>指针来获得想要的值。在实际操作中，可以这样：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">ElemType e5<span class="token punctuation">;</span>             \\ 想要获得第五个元素
<span class="token function">get_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>e5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Fifth element: %d"</span><span class="token punctuation">,</span> e5<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><p>在线性表L中第i个位置插入新的元素<code>e</code>。原来从i到最后一位的元素往后顺延一位。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">insert_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> ElemType e<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    ElemType <span class="token operator">*</span>insert_pos<span class="token punctuation">,</span> <span class="token operator">*</span>end_pos<span class="token punctuation">,</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> i <span class="token operator">></span> L<span class="token operator">-></span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>        <span class="token comment">// i值不合法</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>length <span class="token operator">>=</span> L<span class="token operator">-></span>listsize<span class="token punctuation">)</span> <span class="token function">allocate_sqlist</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 当前存储空间已满，增加分配</span>
    insert_pos <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// 线性表要插入的位置</span>
    end_pos <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span>L<span class="token operator">-></span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// 线性表末尾的位置</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> end_pos<span class="token punctuation">;</span> p <span class="token operator">>=</span> insert_pos<span class="token punctuation">;</span> p<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>
    <span class="token operator">*</span>insert_pos <span class="token operator">=</span> e<span class="token punctuation">;</span>                                   <span class="token comment">// 插入e</span>
    L<span class="token operator">-></span>length<span class="token operator">++</span><span class="token punctuation">;</span>                                       <span class="token comment">// 长度增加1</span>
    <span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意，当前存储空间已满时，会通过一个<code>allocate_sqlit(L)</code>函数分配更多空间。此处<code>L</code>是指向线性表的指针。下面是该函数的定义。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

<span class="token comment">// 增加存储空间</span>
bool <span class="token function">allocate_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>   
    ElemType <span class="token operator">*</span>newbase<span class="token punctuation">;</span>

    newbase <span class="token operator">=</span> <span class="token punctuation">(</span>ElemType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">realloc</span><span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">,</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>listsize <span class="token operator">+</span> LIST_INCREMENT<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ElemType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>newbase<span class="token punctuation">)</span> <span class="token function">exit</span><span class="token punctuation">(</span>OVERFLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 存储分配失败</span>
    L<span class="token operator">-></span>elem <span class="token operator">=</span> newbase<span class="token punctuation">;</span>                 <span class="token comment">// 若成功，给顺序表分配新基址（数组名可以作储存空间指针）</span>
    L<span class="token operator">-></span>listsize <span class="token operator">+=</span> LIST_INCREMENT<span class="token punctuation">;</span>     <span class="token comment">// 增加存储容量</span>
    <span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意，由于该函数只是辅助性的，不应该被外部获取，所以不将它放在头文件中。与此相应的，要在<code>sqlist.c</code>文件开头声明函数原型。</p>
<p>可以看到，重置动态内存的函数<code>realloc</code>和<code>malloc</code>相似，但要先传入一个指向已动态分配空间的指针。</p>
<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><p>在线性表中删除第i个元素，并用e返回其真值。此操作依然需要在删除后把i后面的所有元素往前移动。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">delete_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> ElemType <span class="token operator">*</span>e<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    ElemType <span class="token operator">*</span>del_pos<span class="token punctuation">,</span> <span class="token operator">*</span>end_pos<span class="token punctuation">,</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> i <span class="token operator">></span> L<span class="token operator">-></span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>       <span class="token comment">// i值不合法</span>
    del_pos <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// 被删除元素的位置</span>
    end_pos <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span>L<span class="token operator">-></span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// 表尾元素的位置</span>
    <span class="token operator">*</span>e <span class="token operator">=</span> <span class="token operator">*</span>del_pos<span class="token punctuation">;</span>                                  <span class="token comment">// 将被删除元素的值赋给e</span>
    p <span class="token operator">=</span> del_pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                                <span class="token comment">// 将指针指向被删除元素的后一个</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>p<span class="token punctuation">;</span> p <span class="token operator">&lt;=</span> end_pos<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>                                <span class="token comment">// 被删除元素之后的元素左移</span>
    L<span class="token operator">-></span>length<span class="token operator">--</span><span class="token punctuation">;</span>                                    <span class="token comment">// 表长减一</span>
    <span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h3><p>在顺序表中查找第一个与<code>e</code>满足<code>compare()</code>关系的元素的为序。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

<span class="token keyword">int</span> <span class="token function">locate_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">,</span> ElemType e<span class="token punctuation">,</span> <span class="token function">bool</span> <span class="token punctuation">(</span><span class="token operator">*</span> compare<span class="token punctuation">)</span><span class="token punctuation">(</span>ElemType<span class="token punctuation">,</span> ElemType<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    ElemType <span class="token operator">*</span>p<span class="token punctuation">;</span>

    p <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                               <span class="token comment">// p 指向第一个元素的位置</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> L<span class="token operator">-></span>length <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span>compare<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token comment">// 当i在长度以内，以及不符合条件</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>                                         <span class="token comment">// 增加次序</span>
        p<span class="token operator">++</span><span class="token punctuation">;</span>                                         <span class="token comment">// 指向下一个</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> L<span class="token operator">-></span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> i<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment">// 若不存在</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>此处最重要的是传入一个指向<code>compare()</code>函数的指针。其形式参数应该如下格式：</p>
<pre class="line-numbers language-none"><code class="language-none">返回类型 (* 函数名)(传入类型);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>其实际参数可以直接用函数名传入：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">locate_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>L<span class="token punctuation">,</span> e<span class="token punctuation">,</span> compare<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>此处将会用的<code>compare()</code>比较函数的将定义在<code>main.c</code>里，这样可以保证程序的可移植，对于使用<code>sqlist.h</code>的不同源文件可以定制不同的比较函数。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"main.c"</span>

bool <span class="token function">equal</span><span class="token punctuation">(</span><span class="token keyword">int</span> e1<span class="token punctuation">,</span> <span class="token keyword">int</span> e2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e1 <span class="token operator">==</span> e2<span class="token punctuation">)</span> <span class="token keyword">return</span> true<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="前驱"><a href="#前驱" class="headerlink" title="前驱"></a>前驱</h3><p>返回某个元素<code>cur_e</code>在线性表中的前驱，同样，用一个指针返回结果。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">prior_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">,</span> ElemType cur_e<span class="token punctuation">,</span> ElemType <span class="token operator">*</span>pre_e<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> cur_e<span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> L<span class="token operator">-></span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> cur_e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token operator">*</span>pre_e <span class="token operator">=</span> L<span class="token operator">-></span>elem<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> true<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="后驱"><a href="#后驱" class="headerlink" title="后驱"></a>后驱</h3><p>返回某个元素<code>cur_e</code>在线性表中的后驱，用一个指针返回。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">next_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">,</span> ElemType cur_e<span class="token punctuation">,</span> ElemType <span class="token operator">*</span>next_e<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span>L<span class="token operator">-></span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> cur_e<span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> L<span class="token operator">-></span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> cur_e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token operator">*</span>next_e <span class="token operator">=</span> L<span class="token operator">-></span>elem<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> true<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h3><p>用一个<code>visit</code>函数遍历线性表内的元素，同样，函数通过指针传入。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">traverse_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">,</span> <span class="token function">bool</span> <span class="token punctuation">(</span><span class="token operator">*</span>visit<span class="token punctuation">)</span><span class="token punctuation">(</span>ElemType<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token operator">-></span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> L<span class="token operator">-></span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">visit</span><span class="token punctuation">(</span>L<span class="token operator">-></span>elem<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>同样，<code>visit</code>将定义在<code>main.c</code>中。此处的例子中，<code>visit</code>将打印遇到的线性表元素值。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"main.c"</span>

bool <span class="token function">visit</span><span class="token punctuation">(</span><span class="token keyword">int</span> e<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="填充"><a href="#填充" class="headerlink" title="填充"></a>填充</h3><p>此操作不属于上面列出的抽象数据类型操作，本质上是重复使用插入操作，但定义此操作可以带来很多方便。这个操作接受一个数组，把它的元素填充到线性表中。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token string">"sqlist.c"</span>

bool <span class="token function">populate_sqlist</span><span class="token punctuation">(</span>SqList <span class="token operator">*</span>L<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">,</span> ElemType inputs<span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">insert_sqlist</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> inputs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>我们的测试用例写在<code>main.c</code>中。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"sqlist.h"</span>    <span class="token comment">//将头文件typedef定义为int</span></span>

bool <span class="token function">visit</span><span class="token punctuation">(</span><span class="token keyword">int</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
bool <span class="token function">equal</span><span class="token punctuation">(</span><span class="token keyword">int</span> e1<span class="token punctuation">,</span> <span class="token keyword">int</span> e2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    SqList num_list<span class="token punctuation">;</span>

    <span class="token comment">// 初始化顺序线性表</span>
    <span class="token function">init_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 插入10-20</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">insert_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token operator">*</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// 查表的长度</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Length: %d\n"</span><span class="token punctuation">,</span> <span class="token function">length_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 提取第五个元素</span>
    <span class="token keyword">int</span> five_elem<span class="token punctuation">;</span>
    <span class="token function">get_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>five_elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"5th elem: %d\n"</span><span class="token punctuation">,</span> five_elem<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 插入99到第五位</span>
    <span class="token function">insert_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 删除第2个元素</span>
    <span class="token keyword">int</span> deleted_e<span class="token punctuation">;</span>
    <span class="token function">delete_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>deleted_e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"deleted 2nd elem: %d\n"</span><span class="token punctuation">,</span> deleted_e<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 查找等于120的元素</span>
    <span class="token keyword">int</span> find_pos<span class="token punctuation">;</span>
    find_pos <span class="token operator">=</span> <span class="token function">locate_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> equal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Found at: %d\n"</span><span class="token punctuation">,</span> find_pos<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 100的前驱</span>
    <span class="token keyword">int</span> pre_e<span class="token punctuation">;</span>
    <span class="token function">prior_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>pre_e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Predecessor: %d\n"</span><span class="token punctuation">,</span> pre_e<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//160的后驱</span>
    <span class="token keyword">int</span> next_e<span class="token punctuation">;</span>
    <span class="token function">next_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>next_e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Successor: %d\n"</span><span class="token punctuation">,</span> next_e<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 打印整个表格</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Print the list: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">traverse_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> visit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"----End of Print----\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 清空表</span>
    <span class="token function">clear_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"----cleared----\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Print the list: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">traverse_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> visit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"----End of Print----\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 导入数组</span>
    <span class="token keyword">int</span> new_list<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">populate_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> new_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Print the list: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">traverse_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">,</span> visit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"----End of Print----\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    

    <span class="token comment">// 销毁表</span>
    <span class="token function">destroy_sqlist</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>num_list<span class="token punctuation">.</span>elem<span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Destroyed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// visit 与 compare 的定义见上文。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在终端中，使用如下命令编译文件。</p>
<pre class="line-numbers language-none"><code class="language-none">gcc -o sqlist main.c sqlist.c sqlist.h<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>运行结果如下：</p>
<pre class="line-numbers language-none"><code class="language-none">Length: 10
5th elem: 100
deleted 2nd elem: 40
Found at: 6
Predecessor: 99
Successor: 180
Print the list:
20
60
80
99
100
120
140
160
180
200
----End of Print----
----cleared----
Print the list:
----End of Print----
Print the list:
1
2
3
4
5
6
----End of Print----
Destroyed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/C%E8%AF%AD%E8%A8%80/" rel="tag"># C语言</a>
              <a href="/blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag"># 数据结构</a>
              <a href="/blog/tags/CS/" rel="tag"># CS</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/blog/2021/02/09/hello-world/" rel="prev" title="你好，幸会">
                  <i class="fa fa-chevron-left"></i> 你好，幸会
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/blog/2021/02/23/ml-sklearn-classification/" rel="next" title="sklearn机器学习：Classification">
                  sklearn机器学习：Classification <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
  
  
  



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fas fa-h-square"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">黄梓聪</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/schemes/muse.js"></script><script src="/blog/js/next-boot.js"></script>

  















  








  

  

  

</body>
</html>
